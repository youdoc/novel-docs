(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{291:function(a,t,s){"use strict";s.r(t);var e=s(10),r=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"项目部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目部署"}},[a._v("#")]),a._v(" 项目部署")]),a._v(" "),t("h2",{attrs:{id:"服务器购买和配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务器购买和配置"}},[a._v("#")]),a._v(" 服务器购买和配置")]),a._v(" "),t("p",[a._v("我们可以前往"),t("a",{attrs:{href:"https://activity.huaweicloud.com/828_promotion/index.html?fromacct=bf5b45d9-d4a3-4f9e-9d3e-8280935375c6&utm_source=aHdpZF9vZjJkcXBfYWMyNHg3YmI==&utm_medium=cps&utm_campaign=201905",target:"_blank",rel:"noopener noreferrer"}},[a._v("华为云"),t("OutboundLink")],1),a._v("、"),t("a",{attrs:{href:"https://cloud.tencent.com/act/cps/redirect?redirect=1079&cps_key=736e609d66e0ac4e57813316cec6fd0b&from=console",target:"_blank",rel:"noopener noreferrer"}},[a._v("腾讯云"),t("OutboundLink")],1),a._v("、阿里云和百度云等云平台购买服务器。这里以购买华为云服务器为例，操作步骤如下：")]),a._v(" "),t("ol",[t("li",[t("a",{attrs:{href:"https://activity.huaweicloud.com/828_promotion/index.html?fromacct=bf5b45d9-d4a3-4f9e-9d3e-8280935375c6&utm_source=aHdpZF9vZjJkcXBfYWMyNHg3YmI==&utm_medium=cps&utm_campaign=201905",target:"_blank",rel:"noopener noreferrer"}},[a._v("点击此处"),t("OutboundLink")],1),a._v("前往华为云产品折扣页面购买活动产品，如果没有华为云账号需要先进行注册和实名认证。")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/huaweicloud13.png",alt:""}})]),a._v(" "),t("p",[t("strong",[a._v("注：预算有限的同学可以选择"),t("a",{attrs:{href:"https://cloud.tencent.com/act/cps/redirect?redirect=1079&cps_key=736e609d66e0ac4e57813316cec6fd0b&from=console",target:"_blank",rel:"noopener noreferrer"}},[a._v("腾讯云"),t("OutboundLink")],1),a._v("，具体操作差不多，算是目前优惠力度最大的云平台。")])]),a._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[a._v("选好想要购买的云服务器后，点击立即购买，更换系统镜像为 CentOS，其它规格配置默认即可，如下所示：")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/huaweicloud2.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[a._v("进入"),t("a",{attrs:{href:"https://console.huaweicloud.com/ecm",target:"_blank",rel:"noopener noreferrer"}},[a._v("华为云控制台"),t("OutboundLink")],1),a._v("，点击我的资源中的弹性云服务器，进入云服务器列表，如下所示：")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/huaweicloud3.png",alt:""}}),a._v(" "),t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/huaweicloud4.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[a._v("安全组规则配置，放行 80 端口，如下所示：")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/huaweicloud8.png",alt:""}}),a._v(" "),t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/huaweicloud9.png",alt:""}}),a._v(" "),t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/huaweicloud10.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[a._v("重置远程登录密码，如下所示：")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/huaweicloud5.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"6"}},[t("li",[a._v("重置远程登录密码后，开始远程登录，如下所示：")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/huaweicloud6.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"7"}},[t("li",[a._v("登录成功后的界面如下所示：")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/huaweicloud7.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"域名购买和配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#域名购买和配置"}},[a._v("#")]),a._v(" 域名购买和配置")]),a._v(" "),t("p",[a._v("为了学习更多的云平台，这次选择在"),t("a",{attrs:{href:"https://curl.qcloud.com/vET2Mrgq",target:"_blank",rel:"noopener noreferrer"}},[a._v("腾讯云"),t("OutboundLink")],1),a._v("进行域名购买和配置，其它云平台的操作也都差不多，具体步骤如下：")]),a._v(" "),t("ol",[t("li",[a._v("进入"),t("a",{attrs:{href:"https://curl.qcloud.com/vET2Mrgq",target:"_blank",rel:"noopener noreferrer"}},[a._v("腾讯云"),t("OutboundLink")],1),a._v("，搜索域名注册，购买你想要注册的域名：")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/tencentcloud1.png",alt:""}}),a._v(" "),t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/tencentcloud2.png",alt:""}}),a._v(" "),t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/tencentcloud3.png",alt:""}}),a._v(" "),t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/tencentcloud4.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[a._v("进入到腾讯云的"),t("a",{attrs:{href:"https://console.cloud.tencent.com/domain/all-domain",target:"_blank",rel:"noopener noreferrer"}},[a._v("域名控制台"),t("OutboundLink")],1),a._v("，划动到页面底部，点击解析按钮：")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/tencentcloud5.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[a._v("点击左上角添加记录按钮，添加前台门户网站（book.xxyopen.com）和后端接口（api.book.xxyopen.com）的域名解析记录（服务器公网IP可在华为云控制台的服务器列表获取）：")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/tencentcloud6.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/tencentcloud7.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/tencentcloud8.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"docker-安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装"}},[a._v("#")]),a._v(" Docker 安装")]),a._v(" "),t("ol",[t("li",[a._v("下载并运行 Docker 一键安装脚本")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-sSL")]),a._v(" https://get.daocloud.io/docker "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v("\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("启动 Docker 服务")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl start "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v("\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("查看 Docker 版本")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v("\n")])])]),t("h2",{attrs:{id:"mysql-安装和配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql-安装和配置"}},[a._v("#")]),a._v(" MySQL 安装和配置")]),a._v(" "),t("ol",[t("li",[a._v("Docker 方式安装 MySQL8.0")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-itd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" mysql8.0 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--restart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("always "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v(":3306 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("123456")]),a._v(" mysql:8.0\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("上传 SQL 脚本文件"),t("code",[a._v("novel_data.sql")]),a._v("和"),t("code",[a._v("novel_struc.sql")]),a._v("到服务器")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/deploy/huaweicloud11.png",alt:""}})]),a._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[a._v("导入 SQL 脚本文件到 MySQL 容器")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" novel_data.sql mysql8.0:/tmp/\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" novel_struc.sql mysql8.0:/tmp/\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[a._v("登入到 MySQL 容器内的 MySQL 服务")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" mysql8.0 mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-uroot")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p123456")]),a._v("\n")])])]),t("ol",{attrs:{start:"5"}},[t("li",[a._v("创建数据库")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("database")]),a._v(" novel "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("default")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("character")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" utf8mb4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("use")]),a._v(" novel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("ol",{attrs:{start:"6"}},[t("li",[a._v("执行 SQL 文件")])]),a._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("source "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("tmp"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("novel_struc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sql")]),a._v("\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[a._v("source "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("tmp"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("novel_data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("sql")]),a._v("\n")])])]),t("ol",{attrs:{start:"7"}},[t("li",[t("p",[a._v("根据需要创建其它远程访问账号或修改 root 账号的远程访问权限")])]),a._v(" "),t("li",[t("p",[a._v("退出 MySQL 容器")])])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h2",{attrs:{id:"redis-安装和配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redis-安装和配置"}},[a._v("#")]),a._v(" Redis 安装和配置")]),a._v(" "),t("ol",[t("li",[a._v("Docker 方式安装最新版 Redis")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" redis8.0 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--restart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("always "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("6379")]),a._v(":6379 redis "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--requirepass")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"123456"')]),a._v(" \n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("根据需要开启 Redis 的远程访问权限")])]),a._v(" "),t("h2",{attrs:{id:"jdk-安装和配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jdk-安装和配置"}},[a._v("#")]),a._v(" JDK 安装和配置")]),a._v(" "),t("p",[a._v("yum 安装 JDK 21")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" java-21-openjdk.x86_64 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n")])])]),t("h2",{attrs:{id:"后端服务部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#后端服务部署"}},[a._v("#")]),a._v(" 后端服务部署")]),a._v(" "),t("ol",[t("li",[t("p",[a._v("下载后端项目源码")])]),a._v(" "),t("li",[t("p",[a._v("修改 "),t("code",[a._v("application.yml")]),a._v(" 和 "),t("code",[a._v("redisson.yml")]),a._v(" 文件中的 MySQL 配置和 Redis 配置")])]),a._v(" "),t("li",[t("p",[a._v("修改 "),t("code",[a._v("application.yml")]),a._v(" 文件中的跨域配置")])]),a._v(" "),t("li",[t("p",[a._v("项目根目录下运行"),t("code",[a._v("mvn clean package -Dmaven.test.skip")]),a._v("命令打包")])]),a._v(" "),t("li",[t("p",[a._v("上传打包后的 jar 文件到服务器")])]),a._v(" "),t("li",[t("p",[t("code",[a._v("nohup java -jar novel-<版本号>.jar &")]),a._v(" 命令启动后端服务 "),t("a",{attrs:{href:"https://www.xxyopen.com/2022/08/06/java/thread.html#nohup",target:"_blank",rel:"noopener noreferrer"}},[a._v("nohup 介绍"),t("OutboundLink")],1)])])]),a._v(" "),t("h2",{attrs:{id:"nginx-安装和配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-安装和配置"}},[a._v("#")]),a._v(" Nginx 安装和配置")]),a._v(" "),t("ol",[t("li",[a._v("启动一个最新版 Nginx 的 Docker 临时容器")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" nginx nginx\n")])])]),t("p",[a._v("其中，Nginx 运行在 Docker 容器中对应的目录如下：")]),a._v(" "),t("ul",[t("li",[a._v("配置文件目录：/etc/nginx")]),a._v(" "),t("li",[a._v("日志目录：/var/log/nginx")]),a._v(" "),t("li",[a._v("项目根目录：/usr/share/nginx/html")])]),a._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[a._v("复制 Nginx 的配置文件到宿主机中")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" nginx\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" nginx\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" conf\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" conf\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" nginx:/etc/nginx ./\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" html\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" log\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("配置后端服务的反向代理")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" conf/nginx/conf.d/novel.conf\n")])])]),t("div",{staticClass:"language-nginx novel.conf extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# server {")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#    listen       80;")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#    server_name  book.xxyopen.com;")]),a._v("\n    \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#    location / {")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#       root /www/novel;")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#       index index.html index.htm;")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#   }")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# }")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("server")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("listen")]),a._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("server_name")]),a._v("  api.book.xxyopen.com")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("location")]),a._v(" /")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("proxy_set_header")]),a._v("   Host             "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$host")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#       proxy_set_header   X-Real-IP        $remote_addr;")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("proxy_set_header")]),a._v("   X-Forwarded-For  "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$proxy_add_x_forwarded_for")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("proxy_pass")]),a._v("   http://192.168.0.58:8888")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 不能使用 127.0.0.1，要使用宿主机 IP")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[a._v("停止之前启动的临时容器，并删除")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" stop nginx\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" nginx\n")])])]),t("ol",{attrs:{start:"5"}},[t("li",[a._v("启动新的 Nginx 容器")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")]),a._v(":80 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("443")]),a._v(":443 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" nginx "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--restart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("always "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("TZ")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Asia/Shanghai"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /root/nginx/html:/usr/share/nginx/html:ro "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /root/nginx/conf/nginx:/etc/nginx/:ro "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /root/nginx/log:/var/log/nginx nginx\n")])])]),t("p",[a._v("其中，")]),a._v(" "),t("ul",[t("li",[a._v(":ro：表示容器内部的 nginx 文件是只读的，想要修改配置内容，只能修改宿主机的 conf 文件夹。这样带来的好处是安全性更高")]),a._v(" "),t("li",[a._v('-e TZ="Asia/Shanghai"：表示把时区设置为中国的时区')])]),a._v(" "),t("ol",{attrs:{start:"6"}},[t("li",[a._v("如果出现问题，查看错误日志")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("tail -f log/error.log\n")])])]),t("h2",{attrs:{id:"前端网站部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前端网站部署"}},[a._v("#")]),a._v(" 前端网站部署")]),a._v(" "),t("ol",[t("li",[t("p",[a._v("下载前端项目源码")])]),a._v(" "),t("li",[t("p",[a._v("修改 "),t("code",[a._v(".env.production")]),a._v(" 中的生产环境配置")])]),a._v(" "),t("li",[t("p",[a._v("项目根目录下运行 "),t("code",[a._v("yarn build")]),a._v(" 命令构建")])]),a._v(" "),t("li",[t("p",[a._v("上传"),t("code",[a._v("dist")]),a._v("文件夹中的内容到到服务器"),t("code",[a._v("/root/nginx/html")]),a._v("目录中")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);