(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{297:function(a,s,t){"use strict";t.r(s);var e=t(10),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"服务器部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#服务器部署"}},[a._v("#")]),a._v(" 服务器部署")]),a._v(" "),s("blockquote",[s("p",[a._v("本部署教程基于 Ubuntu 系统，但适用于其它绝大部分 Linux 发行版。")])]),a._v(" "),s("h2",{attrs:{id:"系统要求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#系统要求"}},[a._v("#")]),a._v(" 系统要求")]),a._v(" "),s("ul",[s("li",[a._v("操作系统：Linux")]),a._v(" "),s("li",[a._v("内存大小：10G+（推荐 16G）")]),a._v(" "),s("li",[a._v("磁盘容量：30G+（推荐 50G）")])]),a._v(" "),s("h2",{attrs:{id:"测试环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试环境"}},[a._v("#")]),a._v(" 测试环境")]),a._v(" "),s("ul",[s("li",[a._v("操作系统：Ubuntu 22.04 LTS x86_64")]),a._v(" "),s("li",[a._v("内存大小：10G")]),a._v(" "),s("li",[a._v("磁盘容量：30G")])]),a._v(" "),s("h2",{attrs:{id:"后端服务部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#后端服务部署"}},[a._v("#")]),a._v(" 后端服务部署")]),a._v(" "),s("p",[a._v("后端服务使用 Docker-Compose 一键部署，具体步骤如下：")]),a._v(" "),s("ol",[s("li",[a._v("下载源码。")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" clone git@github.com:201206030/novel-cloud.git\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("进入源码根目录，执行 docker 打包脚本，生成 "),s("code",[a._v("docker.zip")]),a._v(" 压缩文件。")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v(" bin/package.sh\n")])])]),s("blockquote",[s("p",[a._v("该脚本目前只能在 Linux 和 macOS 上运行，由于本人没有 Windows 电脑，暂时不能提供 Windows 上运行的脚本，所以 Windows 用户需要手动去操作一下。")])]),a._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[s("p",[a._v("登录服务器，上传相关文件到服务器上，包括上一步打包好的 "),s("code",[a._v("docker.zip")]),a._v("、novel-cloud 源码下的 "),s("code",[a._v("doc/init.sql")]),a._v(" 和 "),s("code",[a._v("https://gitee.com/novel_dev_team/novel/blob/master/doc/sql/novel.sql.zip")]),a._v(" 压缩包下的 "),s("code",[a._v("novel_data.sql")]),a._v(" 文件。")])]),a._v(" "),s("li",[s("p",[a._v("创建 "),s("code",[a._v("/data/docker/mysql/data")]),a._v(" 目录，将上传的 "),s("code",[a._v("init.sql")]),a._v(" 移动到 "),s("code",[a._v("/data/docker/mysql/")]),a._v(" 目录下。")])])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /data/docker/mysql/data\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" init.sql /data/docker/mysql/\n")])])]),s("ol",{attrs:{start:"5"}},[s("li",[a._v("安装 Docker Compose，Ubuntu 系统下使用如下命令安装。")])]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker-compose")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n")])])]),s("blockquote",[s("p",[a._v("其它系统请参考：https://www.runoob.com/docker/docker-compose.html")])]),a._v(" "),s("ol",{attrs:{start:"6"}},[s("li",[a._v("通过 "),s("code",[a._v("unzip docker.zip")]),a._v(" 命令解压 "),s("code",[a._v("docker.zip")]),a._v(" 压缩包，在 "),s("code",[a._v("docker-compose.yml")]),a._v(" 的同级目录下执行如下命令来创建和运行所有的容器。")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker-compose")]),a._v(" up "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v("\n")])])]),s("ol",{attrs:{start:"7"}},[s("li",[a._v("通过 "),s("code",[a._v("sudo docker ps")]),a._v(" 命令查看容器启动状况。")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://www.xxyopen.com/images/resource/docs/novel-cloud/docker-ps.png",alt:""}})]),a._v(" "),s("ol",{attrs:{start:"8"}},[s("li",[a._v("等待 Docker 容器创建并启动成功后，导入 "),s("code",[a._v("novel_data.sql")]),a._v(" 中的小说数据到 "),s("code",[a._v("novel-cloud")]),a._v(" 数据库中。")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" novel_data.sql novel-mysql:/tmp/\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" novel-mysql mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-uroot")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-ptest123456")]),a._v("\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("use novel-cloud"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" names utf8mb4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" /tmp/novel_data.sql\n")])])]),s("ol",{attrs:{start:"9"}},[s("li",[s("p",[a._v("登录 nacos 配置中心，导入 novel-cloud 源码下 "),s("code",[a._v("doc/nacos")]),a._v(" 目录中的配置文件，并修改 MySQL、Redis、RabbitMQ、Elasticsearch、XXL-JOB 等中间件的配置信息。")])]),a._v(" "),s("li",[s("p",[a._v("登录 Kibana，执行 novel-cloud 源码下 "),s("code",[a._v("doc/es/book.http")]),a._v(" 文件中的小说索引创建语句。")])]),a._v(" "),s("li",[s("p",[a._v("登录 xxl-job 控制台，点击任务管理菜单，执行同步小说数据到 Elasticsearch 的任务导入 MySQL 中的小说数据到 Elasticsearch。")])])]),a._v(" "),s("h2",{attrs:{id:"前台网站部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前台网站部署"}},[a._v("#")]),a._v(" 前台网站部署")]),a._v(" "),s("p",[a._v("请参考 "),s("RouterLink",{attrs:{to:"/course/novel/6.html#nginx-安装和配置"}},[a._v("novel 项目的前台网站部署")])],1)])}),[],!1,null,null,null);s.default=r.exports}}]);